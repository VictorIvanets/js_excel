(()=>{"use strict";var __webpack_modules__={699:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function parse(){let value=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(value.startsWith("="))try{return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{q:()=>parse})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var __webpack_exports__={};(()=>{class t{constructor(t){this.$el="string"==typeof t?document.querySelector(t):t}html(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}text(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}clear(){return this.html(""),this}append(e){return e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}get data(){return this.$el.dataset}closest(t){return e(this.$el.closest(t))}getCoords(){return this.$el.getBoundingClientRect()}off(t,e){this.$el.removeEventListener(t,e)}on(t,e){this.$el.addEventListener(t,e)}findAll(t){return this.$el.querySelectorAll(t)}find(t){return e(this.$el.querySelector(t))}css(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((e=>{this.$el.style[e]=t[e]}))}getStyles(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((t,e)=>(t[e]=this.$el.style[e],t)),{})}addClass(t){return this.$el.classList.add(t),this}removeClass(t){return this.$el.classList.remove(t),this}id(t){if(t){const t=this.id().split(":");return{row:+t[0],col:+t[1]}}return this.data.id}focus(){return this.$el.focus(),this}attr(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.setAttribute(t)}}function e(e){return new t(e)}e.create=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=document.createElement(t);return r&&n.classList.add(r),e(n)};class r{static get path(){return window.location.hash.slice(1)}static get param(){return r.path.split("/")[1]}static navigate(t){window.location.hash=t}}class n{constructor(t){this.params=t}getRoot(){throw new Error("Root no implimented")}afterRender(){}destroy(){}}function s(t,e){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function i(t){const e=s(t),r=t.split(":")[1];return'\n    <li class="db__table__list__record">\n    <a class="db__table__list__record_a" href="#excel/'.concat(r,'">').concat(e.title,"</a> <strong>\n    ").concat(new Date(e.openDate).toLocaleDateString()," - \n    ").concat(new Date(e.openDate).toLocaleTimeString(),"\n    </strong>\n    </li>")}class o{constructor(){this.listeners={}}emit(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((t=>{t(...r)})),!0)}subscribe(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!==e))}}}class a{constructor(t){this.store=t,this.sub=null,this.prevState={}}subscribeComponents(t){this.prevState=this.store.getState(),this.sub=this.store.subscribe((e=>{Object.keys(e).forEach((r=>{var n,s;n=this.prevState[r],s=e[r],("object"==typeof n&&"object"==typeof s?JSON.stringify(n)===JSON.stringify(s):n===s)||t.forEach((t=>{if(t.isWatching(r)){const n={[r]:e[r]};t.storeChanged(n)}}))})),this.prevState=this.store.getState()}))}unsubscribeFromStor(){this.sub.unsubscribe()}}const c="TABLE_RESIZE",l="CHANGE_TEXT",u="APPLY_STYLE",h="CHANGE_STYLE",d="CHANGE_TITLE",p="UPDATE_DATE";class f{constructor(t){this.components=t.components||[],this.store=t.store,this.emitter=new o,this.subscriber=new a(this.store)}getRoot(){const t=e.create("div","excel"),r={emitter:this.emitter,store:this.store};return this.components=this.components.map((n=>{const s=e.create("div",n.className),i=new n(s,r);return s.html(i.toHTML()),t.append(s),i})),t}init(){console.log("production"),this.store.dispatch({type:p}),this.subscriber.subscribeComponents(this.components),this.components.forEach((t=>t.init()))}destroy(){this.subscriber.unsubscribeFromStor(),this.components.forEach((t=>t.destroy()))}}const _={textAlign:"left",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},m="NEW TABLE";class b{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)throw new Error("NO root in DomListener");this.$root=t,this.listeners=e}initDomListener(){this.listeners.forEach((t=>{const e=v(t);if(!this[e])throw new Error("No method ".concat(e," in ").concat(this.name||""," Component"));this[e]=this[e].bind(this),this.$root.on(t,this[e])}))}removeDomListener(){this.listeners.forEach((t=>{const e=v(t);this.$root.off(t,this[e])}))}}function v(t){return"on"+("string"!=typeof(e=t)?"":e.charAt(0).toLocaleUpperCase()+e.slice(1));var e}class g extends b{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e.listeners),this.name=e.name||"",this.emitter=e.emitter,this.subscribe=e.subscribe||[],this.store=e.store,this.unsubscribers=[],this.prepare()}prepare(){}toHTML(){return""}$emit(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.emitter.emit(t,...r)}$on(t,e){const r=this.emitter.subscribe(t,e);this.unsubscribers.push(r)}$dispatch(t){this.store.dispatch(t)}isWatching(t){return this.subscribe.includes(t)}storeChanged(){}init(){this.initDomListener()}destroy(){this.removeDomListener(),this.unsubscribers.forEach((t=>t()))}}class y extends g{constructor(t,e){super(t,{name:"Header",listeners:["input","click"],...e})}toHTML(){const t=this.store.getState().title||m;return'\n        <div class="header__left">\n        <div class="header__left__logo">\n            <img class="header__left__logo__img" src="./favicon.svg" alt="logo">\n        </div>\n        <input class="header__left__input" value="'.concat(t,'" type="text">\n    </div>\n    <div class="header__right">\n\n\n        <button data-button="exit" class="header__right__btn">\n            <i data-button="exit" class="material-icons">exit_to_app</i>\n        </button>\n\n        <button data-button="remove" class="header__right__btn">\n            <i data-button="remove" class="material-icons">delete</i>\n        </button>\n    </div>')}onClick(t){const n=e(t.target);"exit"===n.data.button?r.navigate(""):"remove"===n.data.button&&confirm("Ви дійсно хочете видалити таблицю?")&&(localStorage.removeItem("excel:"+r.param),r.navigate(""))}onInput(t){const r=e(t.target);var n;this.$dispatch((n=r.text(),{type:d,data:n}))}}!function(t,e,r){var n;(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(y,"className","header");class w extends g{constructor(){super(...arguments)}get template(){return JSON.stringify(this.state,null,2)}initState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state={...t}}setState(t){this.state={...this.state,...t},this.$root.html(this.template)}}class S extends w{constructor(t,e){super(t,{name:"Toolbar",listeners:["click"],subscribe:["currentStyles"],...e})}prepare(){this.initState(_)}get template(){return[{icon:"format_align_left",active:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_rightt",active:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underlined",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map((t=>function(t){const e='\n    data-type="button"\n    data-value=\''.concat(JSON.stringify(t.value),"'\n    ");return"\n    <button \n    ".concat(e,'\n    class="toolbar__btn ').concat(t.active?"active":"",'">\n    <i ').concat(e,' class="material-icons">').concat(t.icon,"</i>\n    </button>")}(t))).join("");var t}toHTML(){return this.template}storeChanged(t){this.setState(t.currentStyles)}onClick(t){const r=e(t.target);if("button"===r.data.type){const t=JSON.parse(r.data.value);this.$emit("toolbar:applyStyle",t)}}}!function(t,e,r){var n;(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(S,"className","toolbar");class x extends g{constructor(t,e){super(t,{name:"Formula",listeners:["input","keydown"],subscribe:["currentText"],...e})}toHTML(){return'\n        <div class="formula__info"><h2 class="formula__info__h1">fx</h2></div>\n        <div class="formula__inputbox"><div id="formula" class="formula__inputbox__input" contenteditable="" spellcheck="false"></div></div>\n        '}init(){super.init(),this.$formula=this.$root.find("#formula"),this.$on("table:select",(t=>{this.$formula.text(t.data.value)}))}storeChanged(t){let{currentText:e}=t;this.$formula.text(e)}onInput(t){this.$emit("formula:input",e(t.target).text())}onKeydown(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}}!function(t,e,r){var n;(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(x,"className","formula");var $=__webpack_require__(699);const E={A:65,Z:90},T=120,A=30;function k(t,e){return(t[e]||T)+"px"}function L(t,e){return function(r,n){const s=k(t.colState,n),i="".concat(e,":").concat(n),o=t.dataState[i],a=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((e=>{return"".concat((r=e,r.replace(/([A-Z])/g,(t=>"-".concat(t[0].toLowerCase())))),": ").concat(t[e]);var r})).join(";")}({..._,...t.stylesState[i]});return'\n        <div \n        class="table__row__cell" \n        contenteditable="" \n        data-col="'.concat(n,'"\n        data-type="cell"\n        data-id="').concat(i,'"\n        data-value ="').concat(o||"",'"\n        style="').concat(a,"; width: ").concat(s,'"\n        \n        > ').concat((0,$.q)(o)||"","</div>")}}function C(t){let{col:e,index:r,width:n}=t;return'<div \n    class="table__row__colum" \n    style="width: '.concat(n,'" \n    data-type="resizeble" \n    data-col="').concat(r,'">').concat(e,'\n\n    <div class="col-resize" data-resize="col"></div> \n    </div>')}function N(t,e,r){const n=e?'<div class="row-resize" data-resize="row"></div>':"",s=function(t,e){return(t[e]||A)+"px"}(r,e);return'<div \n            class="table__row" \n            data-type="resizeble"\n            data-row="'.concat(e,'"\n            style = "height: ').concat(s,'"\n            >\n            <div class="table__row-info">\n            ').concat(null===e?"":e,"\n            ").concat(n,'\n            </div>\n            <div class="table__row-data">').concat(t,"</div>\n        </div>")}function j(t,e){return String.fromCharCode(E.A+e)}class O{constructor(){this.group=[],this.current=null}select(t){this.clear(),t.focus().addClass(O.className),this.group.push(t),this.current=t}clear(){this.group.forEach((t=>t.removeClass(O.className))),this.group=[]}get selectedIds(){return this.group.map((t=>t.id()))}selectGroup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clear(),this.group=t,this.group.forEach((t=>t.addClass(O.className)))}applyStyle(t){this.group.forEach((e=>e.css(t)))}}function P(t,e){return t>e&&([e,t]=[t,e]),new Array(e-t+1).fill("").map(((e,r)=>t+r))}!function(t,e,r){var n;(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(O,"className","selected");class D extends g{constructor(t,e){super(t,{name:"Table",listeners:["mousedown","keydown","input"],...e})}prepare(){this.selection=new O}init(){super.init(),this.selectCell(this.$root.find('[data-id="0:0"]')),this.$on("formula:input",(t=>{this.selection.current.attr("data-value",t).text((0,$.q)(t)),this.updateTextStore(t)})),this.$on("formula:done",(()=>{this.selection.current.focus()})),this.$on("toolbar:applyStyle",(t=>{var e;console.log(t),this.selection.applyStyle(t),this.$dispatch((e={value:t,ids:this.selection.selectedIds},{type:u,data:e}))}))}selectCell(t){this.selection.select(t),this.$emit("table:select",t);const e=t.getStyles(Object.keys(_));this.$dispatch({type:h,data:e})}toHTML(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E.Z-E.A+1,n=[],s=new Array(r).fill("").map(j).map(function(t){return function(e,r){return{col:e,index:r,width:k(t.colState,r)}}}(e)).map(C).join("");n.push(N(s,null,{}));for(let s=0;s<t;s++){const t=new Array(r).fill("").map(L(e,s)).join("");n.push(N(t,s+1,e.rowState))}return n.join("")}(20,this.store.getState())}async resizeTable(t){try{const r=await function(t,r){return new Promise((n=>{const s=e(r.target),i=s.closest('[data-type="resizeble"]'),o=i.getCoords(),a=s.data.resize,c="col"===a?"bottom":"right";let l;s.css({opacity:1,[c]:"-2000px"}),document.onmousemove=t=>{if("col"===a){const e=t.pageX-o.right;l=o.width+e,s.css({right:-e+"px"})}else{const e=t.pageY-o.bottom;l=o.height+e,s.css({bottom:-e+"px"})}},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null,"col"===a?(i.css({width:l+"px"}),t.findAll('[data-col="'.concat(i.data.col,'"]')).forEach((t=>t.style.width=l+"px"))):i.css({height:l+"px"}),n({value:l,type:a,id:i.data[a]}),s.css({opacity:0,bottom:0,right:0})}}))}(this.$root,t);this.$dispatch(function(t){return{type:c,data:t}}(r))}catch(t){console.warn(t.massage)}}onMousedown(t){if(function(t){return t.target.dataset.resize}(t))this.resizeTable(t);else if(function(t){return"cell"===t.target.dataset.type}(t)){const r=e(t.target);if(t.shiftKey||t.altKey){console.log(t);const e=function(t,e){const r=t.id(!0),n=e.id(!0),s=P(n.col,r.col),i=P(n.row,r.row);return s.reduce(((t,e)=>(i.forEach((r=>t.push("".concat(r,":").concat(e)))),t)),[])}(r,this.selection.current).map((t=>this.$root.find('[data-id="'.concat(t,'"]'))));this.selection.selectGroup(e)}else this.selectCell(r)}}onKeydown(t){const{key:e}=t;if(["ArrowDown","ArrowUp","ArrowRight","ArrowLeft","Enter","Tab"].includes(e)&&!t.shiftKey){t.preventDefault();const r=this.selection.current.id(!0),n=this.$root.find(function(t,e){let{col:r,row:n}=e;switch(t){case"Enter":case"ArrowDown":n++;break;case"Tab":case"ArrowRight":r++;break;case"ArrowUp":n=n-1<0?0:n-1;break;case"ArrowLeft":r=r-1<0?0:r-1}return'[data-id="'.concat(n,":").concat(r,'"]')}(e,r));this.selectCell(n)}}updateTextStore(t){var e;this.$dispatch((e={id:this.selection.current.id(),value:t},{type:l,data:e}))}onInput(t){this.updateTextStore(e(t.target).text())}}function H(t,e){let r,n;switch(e.type){case c:return r="col"===e.data.type?"colState":"rowState",{...t,[r]:q(t,r,e)};case l:return r="dataState",{...t,currentText:e.data.value,[r]:q(t,r,e)};case h:return{...t,currentStyles:e.data};case u:return r="stylesState",n=t[r]||{},e.data.ids.forEach((t=>{n[t]={...n[t],...e.data.value}})),{...t,[r]:n,currentStyles:{...t.currentStyles,...e.data.value}};case d:return{...t,title:e.data};case p:return{...t,openDate:(new Date).toJSON()};default:return t}}function q(t,e,r){const n=t[e]||{};return n[r.data.id]=r.data.value,n}!function(t,e,r){var n;(e="symbol"==typeof(n=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(D,"className","table");const R={rowState:{},colState:{},dataState:{},stylesState:{},currentText:"",currentStyles:_,title:m,openDate:(new Date).toJSON()};function J(t){return"excel:"+t}new class{constructor(t,r){if(!t)throw new Error("no selector in Router");this.$placeholder=e(t),this.routes=r,this.page=null,this.changePageHandler=this.changePageHandler.bind(this),this.init()}init(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}changePageHandler(){this.page&&this.page.destroy(),this.$placeholder.clear();const t=r.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new t(r.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}destroy(){window.removeEventListener("hashchange",this.changePageHandler)}}("#app",{dashboard:class extends n{getRoot(){const t=Date.now().toString();return e.create("div","db").html('\n        <div class="db__header">\n            <div class="header__left__logo">\n                <img class="header__left__logo__img" src="./favicon.svg" alt="logo">\n            </div>\n                <h1 class="db__header_h1">EXCEL</h1>\n        </div>\n\n        <div class="db__new">\n            <a class="db__create" href="#excel/'.concat(t,'">NEW <br> TABLE</a>\n        </div>\n\n\n        <div class="db__table">\n\n                ').concat(function(){const t=function(){const t=[];for(let e=0;e<localStorage.length;e++){const r=localStorage.key(e);r.includes("excel")&&t.push(r)}return t}();return t.length?'                \n            <div class="db__table__header">\n            <span>Name:</span>\n            <span>Open date:</span>\n            </div>\n\n            <ul class="db__table__list">\n                '.concat(t.map(i).join(""),"\n            </ul>"):'<h3 class="tacenter"> ще немає записів</h3>'}(),"\n\n        </div>"))}},excel:class extends n{getRoot(){const t=this.params?this.params:Date.now().toString(),e=function(t){let e=t({...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},{type:"__INIT__"}),r=[];return{subscribe:t=>(r.push(t),{unsubscribe(){r=r.filter((e=>e!==t))}}),dispatch(n){e=t(e,n),r.forEach((t=>t(e)))},getState:()=>JSON.parse(JSON.stringify(e))}}(H,(n=s(J(t)))?(t=>({...t,currentStyles:_,currentText:""}))(n):(i=R,JSON.parse(JSON.stringify(i)))),r=function(e,r){let n;return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];clearTimeout(n),n=setTimeout((()=>{clearTimeout(n),(e=>{s(J(t),e)})(...r)}),300)}}();var n,i;return e.subscribe(r),this.excel=new f({components:[y,S,x,D],store:e}),this.excel.getRoot()}afterRender(){this.excel.init()}destroy(){this.excel.destroy()}}})})()})();